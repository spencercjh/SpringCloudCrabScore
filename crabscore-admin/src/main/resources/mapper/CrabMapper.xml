<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="top.spencercjh.crabscore.admin.dao.CrabMapper">
    <resultMap id="BaseResultMap" type="top.spencercjh.crabscore.admin.entity.Crab">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="crab_id" property="crabId" jdbcType="INTEGER"/>
        <result column="group_id" property="groupId" jdbcType="INTEGER"/>
        <result column="crab_sex" property="crabSex" jdbcType="INTEGER"/>
        <result column="crab_label" property="crabLabel" jdbcType="VARCHAR"/>
        <result column="crab_weight" property="crabWeight" jdbcType="REAL"/>
        <result column="crab_length" property="crabLength" jdbcType="REAL"/>
        <result column="crab_fatness" property="crabFatness" jdbcType="REAL"/>
        <result column="create_date" property="createDate" jdbcType="TIMESTAMP"/>
        <result column="create_user" property="createUser" jdbcType="VARCHAR"/>
        <result column="update_date" property="updateDate" jdbcType="TIMESTAMP"/>
        <result column="update_user" property="updateUser" jdbcType="VARCHAR"/>
        <result column="competition_id" property="competitionId" jdbcType="INTEGER"/>
        <result column="avatar_url" property="avatarUrl" jdbcType="VARCHAR"/>
    </resultMap>
    <resultMap id="ExtendResultMap" type="top.spencercjh.crabscore.admin.entity.dto.CrabResult">
        <id column="crab_id" property="crabId" jdbcType="INTEGER"/>
        <result column="group_id" property="groupId" jdbcType="INTEGER"/>
        <result column="company_id" property="companyId" jdbcType="INTEGER"/>
        <result column="company_name" property="companyName" jdbcType="VARCHAR"/>
        <result column="crab_sex" property="crabSex" jdbcType="INTEGER"/>
        <result column="crab_label" property="crabLabel" jdbcType="VARCHAR"/>
        <result column="crab_weight" property="crabWeight" jdbcType="REAL"/>
        <result column="crab_length" property="crabLength" jdbcType="REAL"/>
        <result column="crab_fatness" property="crabFatness" jdbcType="REAL"/>
        <result column="create_date" property="createDate" jdbcType="TIMESTAMP"/>
        <result column="create_user" property="createUser" jdbcType="VARCHAR"/>
        <result column="update_date" property="updateDate" jdbcType="TIMESTAMP"/>
        <result column="update_user" property="updateUser" jdbcType="VARCHAR"/>
        <result column="competition_id" property="competitionId" jdbcType="INTEGER"/>
        <result column="avatar_url" property="avatarUrl" jdbcType="VARCHAR"/>
    </resultMap>
    <resultMap id="ExtendResultMap2" type="top.spencercjh.crabscore.admin.entity.dto.CrabScoreResult">
        <id column="crab_id" property="crabId" jdbcType="INTEGER"/>
        <result column="group_id" property="groupId" jdbcType="INTEGER"/>
        <result column="crab_sex" property="crabSex" jdbcType="INTEGER"/>
        <result column="crab_label" property="crabLabel" jdbcType="VARCHAR"/>
        <result column="crab_weight" property="crabWeight" jdbcType="REAL"/>
        <result column="crab_length" property="crabLength" jdbcType="REAL"/>
        <result column="crab_fatness" property="crabFatness" jdbcType="REAL"/>
        <result column="taste_score_fin" property="tasteScoreFin" jdbcType="REAL"/>
        <result column="quality_score_fin" property="qualityScoreFin" jdbcType="REAL"/>
        <result column="create_date" property="createDate" jdbcType="TIMESTAMP"/>
        <result column="create_user" property="createUser" jdbcType="VARCHAR"/>
        <result column="update_date" property="updateDate" jdbcType="TIMESTAMP"/>
        <result column="update_user" property="updateUser" jdbcType="VARCHAR"/>
        <result column="competition_id" property="competitionId" jdbcType="INTEGER"/>
        <result column="avatar_url" property="avatarUrl" jdbcType="VARCHAR"/>
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        crab_id, group_id, crab_sex, crab_label, crab_weight, crab_length, crab_fatness,
        create_date, create_user, update_date, update_user, competition_id,avatar_url
    </sql>
    <select id="selectOneGroupAllCrabAndScore" resultMap="ExtendResultMap2">
        select a.crab_id,
               a.group_id,
               a.crab_sex,
               a.crab_label,
               a.crab_weight,
               a.crab_length,
               a.crab_fatness,
               b.score_fin as taste_score_fin,
               c.score_fin as quality_score_fin,
               a.create_date,
               a.create_user,
               a.update_date,
               a.update_user,
               a.competition_id,
               a.avatar_url
        from rxpb_crab_info as a,
             rxpb_score_taste as b,
             rxpb_score_quality as c
        where a.crab_id = b.score_id
          and b.score_id = c.score_id
          and a.competition_id = #{competitionId,jdbcType=INTEGER}
          and a.group_id = #{groupId,jdbcType=INTEGER}
        order by a.group_id
    </select>
    <select id="sdFatnessByCompetitionIdAndGroupIdAndCrabSex" resultType="java.lang.Float">
        select STDDEV(crab_fatness)
        from rxpb_crab_info
        where competition_id = #{competitionId,jdbcType=INTEGER}
          and group_id = #{groupId,jdbcType=INTEGER}
          and crab_sex = #{crabSex,jdbcType=INTEGER}
    </select>
    <select id="sdWeightByCompetitionIdAndGroupIdAndCrabSex" resultType="java.lang.Float">
        select STDDEV(crab_weight)
        from rxpb_crab_info
        where competition_id = #{competitionId,jdbcType=INTEGER}
          and group_id = #{groupId,jdbcType=INTEGER}
          and crab_sex = #{crabSex,jdbcType=INTEGER}
    </select>
    <select id="averageFatnessByCompetitionIdAndGroupIdAndCrabSex" resultType="java.lang.Float">
        select AVG(crab_fatness)
        from rxpb_crab_info
        where competition_id = #{competitionId,jdbcType=INTEGER}
          and group_id = #{groupId,jdbcType=INTEGER}
          and crab_sex = #{crabSex,jdbcType=INTEGER}
    </select>
    <select id="averageWeightByCompetitionIdAndGroupIdAndCrabSex" resultType="java.lang.Float">
        select AVG(crab_weight)
        from rxpb_crab_info
        where competition_id = #{competitionId,jdbcType=INTEGER}
          and group_id = #{groupId,jdbcType=INTEGER}
          and crab_sex = #{crabSex,jdbcType=INTEGER}
    </select>
    <update id="updateCrabFatness">
        update rxpb_crab_info
        <set>
            <if test="crab_sex == 1">
                crab_fatness=(#{varFatnessM,jdbcType=REAL}*crab_weight*100)/(crab_length*crab_length*crab_length),
            </if>
            <if test="crab_sex ==2">
                crab_fatness=(#{varFatnessF,jdbcType=REAL}*crab_weight*100)/(crab_length*crab_length*crab_length),
            </if>
        </set>
        where competition_id=#{competitionId,jdbcType=INTEGER}
    </update>
    <select id="selectByLabel" resultMap="ExtendResultMap" parameterType="java.lang.String">
        select a.crab_id,
               a.group_id,
               c.company_id,
               c.company_name,
               a.crab_sex,
               a.crab_label,
               a.crab_weight,
               a.crab_length,
               a.crab_fatness,
               a.create_date,
               a.create_user,
               a.update_date,
               a.update_user,
               a.competition_id,
               a.avatar_url
        from rxpb_crab_info as a,
             rxpb_group_info as b,
             rxpb_company_info as c
        where a.group_id = b.group_id
          and b.company_id = c.company_id
          and crab_label = #{crabLabel,jdbcType=VARCHAR}
    </select>
    <select id="selectByCompetitionIdAndGroupIdAndCrabSex" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from rxpb_crab_info
        where competition_id=#{competitionId,jdbcType=INTEGER}
        and group_id=#{groupId,jdbcType=INTEGER}
        and crab_sex=#{crabSex,jdbcType=INTEGER}
    </select>
    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
        <include refid="Base_Column_List"/>
        from rxpb_crab_info
        where crab_id = #{crabId,jdbcType=INTEGER}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        delete from rxpb_crab_info
        where crab_id = #{crabId,jdbcType=INTEGER}
    </delete>
    <insert id="insert" useGeneratedKeys="true" keyProperty="crabId" parameterType="top.spencercjh.crabscore.admin.entity.Crab">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into rxpb_crab_info (crab_id, group_id, crab_sex,
        crab_label, crab_weight, crab_length,
        crab_fatness, create_date, create_user,
        update_date, update_user, competition_id,avatar_url
        )
        values (#{crabId,jdbcType=INTEGER}, #{groupId,jdbcType=INTEGER}, #{crabSex,jdbcType=INTEGER},
        #{crabLabel,jdbcType=VARCHAR}, #{crabWeight,jdbcType=REAL}, #{crabLength,jdbcType=REAL},
        #{crabFatness,jdbcType=REAL}, #{createDate,jdbcType=TIMESTAMP}, #{createUser,jdbcType=VARCHAR},
        #{updateDate,jdbcType=TIMESTAMP}, #{updateUser,jdbcType=VARCHAR}, #{competitionId,jdbcType=INTEGER}
        ,#{avatarUrl,jdbcType=VARCHAR})
    </insert>
    <insert id="insertSelective" useGeneratedKeys="true" keyProperty="crabId" parameterType="top.spencercjh.crabscore.admin.entity.Crab">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into rxpb_crab_info
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="crabId != null">
                crab_id,
            </if>
            <if test="groupId != null">
                group_id,
            </if>
            <if test="crabSex != null">
                crab_sex,
            </if>
            <if test="crabLabel != null">
                crab_label,
            </if>
            <if test="crabWeight != null">
                crab_weight,
            </if>
            <if test="crabLength != null">
                crab_length,
            </if>
            <if test="crabFatness != null">
                crab_fatness,
            </if>
            <if test="createDate != null">
                create_date,
            </if>
            <if test="createUser != null">
                create_user,
            </if>
            <if test="updateDate != null">
                update_date,
            </if>
            <if test="updateUser != null">
                update_user,
            </if>
            <if test="competitionId != null">
                competition_id,
            </if>
            <if test="avatarUrl != null">
                avatar_url
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="crabId != null">
                #{crabId,jdbcType=INTEGER},
            </if>
            <if test="groupId != null">
                #{groupId,jdbcType=INTEGER},
            </if>
            <if test="crabSex != null">
                #{crabSex,jdbcType=INTEGER},
            </if>
            <if test="crabLabel != null">
                #{crabLabel,jdbcType=VARCHAR},
            </if>
            <if test="crabWeight != null">
                #{crabWeight,jdbcType=REAL},
            </if>
            <if test="crabLength != null">
                #{crabLength,jdbcType=REAL},
            </if>
            <if test="crabFatness != null">
                #{crabFatness,jdbcType=REAL},
            </if>
            <if test="createDate != null">
                #{createDate,jdbcType=TIMESTAMP},
            </if>
            <if test="createUser != null">
                #{createUser,jdbcType=VARCHAR},
            </if>
            <if test="updateDate != null">
                #{updateDate,jdbcType=TIMESTAMP},
            </if>
            <if test="updateUser != null">
                #{updateUser,jdbcType=VARCHAR},
            </if>
            <if test="competitionId != null">
                #{competitionId,jdbcType=INTEGER},
            </if>
            <if test="avatarUrl != null">
                #{avatarUrl,jdbcType=VARCHAR}
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="top.spencercjh.crabscore.admin.entity.Crab">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update rxpb_crab_info
        <set>
            <if test="groupId != null">
                group_id = #{groupId,jdbcType=INTEGER},
            </if>
            <if test="crabSex != null">
                crab_sex = #{crabSex,jdbcType=INTEGER},
            </if>
            <if test="crabLabel != null">
                crab_label = #{crabLabel,jdbcType=VARCHAR},
            </if>
            <if test="crabWeight != null">
                crab_weight = #{crabWeight,jdbcType=REAL},
            </if>
            <if test="crabLength != null">
                crab_length = #{crabLength,jdbcType=REAL},
            </if>
            <if test="crabFatness != null">
                crab_fatness = #{crabFatness,jdbcType=REAL},
            </if>
            <if test="createDate != null">
                create_date = #{createDate,jdbcType=TIMESTAMP},
            </if>
            <if test="createUser != null">
                create_user = #{createUser,jdbcType=VARCHAR},
            </if>
            <if test="updateDate != null">
                update_date = #{updateDate,jdbcType=TIMESTAMP},
            </if>
            <if test="updateUser != null">
                update_user = #{updateUser,jdbcType=VARCHAR},
            </if>
            <if test="competitionId != null">
                competition_id = #{competitionId,jdbcType=INTEGER},
            </if>
            <if test="avatarUrl != null">
                avatar_url=#{avatarUrl,jdbcType=VARCHAR}
            </if>
        </set>
        where crab_id = #{crabId,jdbcType=INTEGER}
    </update>
    <update id="updateByPrimaryKey" parameterType="top.spencercjh.crabscore.admin.entity.Crab">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update rxpb_crab_info
        set group_id = #{groupId,jdbcType=INTEGER},
        crab_sex = #{crabSex,jdbcType=INTEGER},
        crab_label = #{crabLabel,jdbcType=VARCHAR},
        crab_weight = #{crabWeight,jdbcType=REAL},
        crab_length = #{crabLength,jdbcType=REAL},
        crab_fatness = #{crabFatness,jdbcType=REAL},
        create_date = #{createDate,jdbcType=TIMESTAMP},
        create_user = #{createUser,jdbcType=VARCHAR},
        update_date = #{updateDate,jdbcType=TIMESTAMP},
        update_user = #{updateUser,jdbcType=VARCHAR},
        competition_id = #{competitionId,jdbcType=INTEGER},
        avatar_url=#{avatarUrl,jdbcType=VARCHAR}
        where crab_id = #{crabId,jdbcType=INTEGER}
    </update>
</mapper>